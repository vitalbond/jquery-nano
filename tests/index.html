<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>jQueryNano</title>

	<script src="../build/jquery-nano.min.js"></script>

	<style>
		table {
			border-collapse: collapse;
			margin: auto;
		}

		td, th {
			border: 1px solid #ccc;
			padding: 5px;
		}

		.ok {
			color: green;
		}

		.ok:after {
			content: 'OK!';
		}

		.error {
			color: red;
		}

		.error:after {
			content: 'Error!';
		}
	</style>

	<script>
		function el(id) {
			return document.getElementById(id);
		}

		function ok(id, cond = true) {
			if (cond) {
				const e = el(id);
				e.classList.add('ok');
				e.classList.remove('error');
			}
		}
	</script>
</head>
<body>

<table>
	<tr>
		<th>Test</th>
		<th>Result</th>
	<tr><td colspan="2"><b>Core</b></td></tr>
	<tr>
		<td>$(document).ready(fn)</td>
		<td id="res_ready" class="error">
			<script>$(document).ready(() => { ok('res_ready'); })</script>
		</td>
	</tr>
	<tr>
		<td>$(fn)</td>
		<td id="res_ready2" class="error">
			<script>$(() => { ok('res_ready2'); })</script>
		</td>
	</tr>
	<tr>
		<td id="test_selectors">Selectors / .length<span /><span /><span /></td>
		<td id="res_selectors" class="error">
			<script>$(() => { ok('res_selectors', $('#test_selectors span').length === 3 && !$('#test_selectors div').length); })</script>
		</td>
	</tr>
	<tr><td colspan="2"><b>AJAX</b></td></tr>
	<tr>
		<td id="test_serialize">.serialize()<div style="display: none;"><form><input type="hidden" name="hidden" value="hidden" /><select name="select"><option value="1"></option><option value="2" selected></option></select></form></div></td>
		<td id="res_serialize" class="error">
			<script>
				$(() => {
					ok(
						'res_serialize',
						$('#test_serialize form').serialize() === 'hidden=hidden&select=2'
					);
				})
			</script>
		</td>
	</tr>
	<tr><td colspan="2"><b>Miscellaneous</b></td></tr>
	<tr>
		<td id="test_get">.get(n)<span class="first" /><span class="second" /><span /></td>
		<td id="res_get" class="error">
			<script>$(() => { ok('res_get', $('#test_get span').get(0).classList.contains('first') && $('#test_get span').get(1).classList.contains('second')); })</script>
		</td>
	</tr>
	<tr>
		<td id="test_each">.each(fn)<span class="first" /><span class="second" /><span class="third" /></td>
		<td id="res_each" class="error">
			<script>$(() => {
				$('#test_each span').each(function (i, el) { (this === el) && $(el).addClass('test-class').addClass('test-class-' + i); });
				ok('res_each',
				  $('#test_each span.test-class').length === 3
				  && $('#test_each span.third').hasClass('test-class-2'));
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_map">.map(fn)<span class="first"></span><span class="second"></span><span class="third"></span></td>
		<td id="res_map" class="error">
			<script>$(() => {
				ok('res_map',
					JSON.stringify($('#test_map span').map(function (i, el) { return (this === el) && el.getAttribute('class'); })) === JSON.stringify(['first', 'second', 'third']))
			})</script>
		</td>
	</tr>
	<tr><td colspan="2"><b>Manipulations</b></td></tr>
	<tr>
		<td id="test_showhidetoggle">.hide()/.show()/.toggle()<div style="display: none;"></div></td>
		<td id="res_showhidetoggle" class="error">
			<script>$(() => {
				ok(
					'res_showhidetoggle',
					$('#test_focus div').show()
					&& $('#test_focus div').get(0).style.display === ''
					&& $('#test_focus div').hide()
					&& $('#test_focus div').get(0).style.display === 'none'

					&& $('#test_focus div').toggle()
					&& $('#test_focus div').get(0).style.display === ''
					&& $('#test_focus div').toggle()
					&& $('#test_focus div').get(0).style.display === 'none'
					&& $('#test_focus div').toggle(true)
					&& $('#test_focus div').get(0).style.display === ''
					&& $('#test_focus div').toggle(true)
					&& $('#test_focus div').get(0).style.display === ''
					&& $('#test_focus div').toggle(false)
					&& $('#test_focus div').get(0).style.display === 'none'
					&& $('#test_focus div').toggle(false)
					&& $('#test_focus div').get(0).style.display === 'none'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_addclass">.addClass()<span></span><span></span></td>
		<td id="res_addclass" class="error">
			<script>$(() => {
				$('#test_addclass span').addClass('test');
				ok('res_addclass', document.querySelectorAll('#test_addclass span.test').length === 2);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_removeclass">.removeClass()<span class="test"></span><span class="test"></span></td>
		<td id="res_removeclass" class="error">
			<script>$(() => {
				$('#test_removeclass span').removeClass('test');
				ok('res_removeclass', document.querySelectorAll('#test_removeclass span.test').length === 0);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_toggleclass">.toggleClass()<span class="test"></span><span></span></td>
		<td id="res_toggleclass" class="error">
			<script>$(() => {
				let res = true;
				$('#test_toggleclass span').toggleClass('test');
				res = res
				  && !$('#test_toggleclass span').get(0).classList.contains('test')
				  && $('#test_toggleclass span').get(1).classList.contains('test');
				$('#test_toggleclass span').toggleClass('test', true);
				res = res
					&& $('#test_toggleclass span').get(0).classList.contains('test')
					&& $('#test_toggleclass span').get(1).classList.contains('test');
				$('#test_toggleclass span').toggleClass('test', false);
				res = res
					&& !$('#test_toggleclass span').get(0).classList.contains('test')
					&& !$('#test_toggleclass span').get(1).classList.contains('test');
				ok('res_toggleclass', res);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_hasclass">.hasClass()<span class="test test2"></span><span class="test"></span></td>
		<td id="res_hasclass" class="error">
			<script>$(() => {
				ok('res_hasclass', $('#test_hasclass span').hasClass('test') && !$('#test_hasclass span').hasClass('test2'));
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_after">.after(content)<div style="display: none;"><span class="span1"></span></div></td>
		<td id="res_after" class="error">
			<script>$(() => {
				$('#test_after .span1').after('<span class="span2"></span>');
				$('#test_after .span1').after('Text');
				const el = document.createElement('span');
				el.className = 'span3'
				$('#test_after .span1').after(el);
				$('#test_after .span1').after($('<span class="span4"></span>'));
				ok(
				  'res_after',
				  $('#test_after span').get(1).classList.contains('span4')
				  && $('#test_after span').get(2).classList.contains('span3')
				  && $('#test_after span').get(3).classList.contains('span2')
				  && $('#test_after div').get(0).innerText === 'Text'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_before">.before(content)<div style="display: none;"><span class="span1"></span></div></td>
		<td id="res_before" class="error">
			<script>$(() => {
			$('#test_before .span1').before('<span class="span2"></span>');
			$('#test_before .span1').before('Text');
			const el = document.createElement('span');
			el.className = 'span3'
			$('#test_before .span1').before(el);
			$('#test_before .span1').before($('<span class="span4"></span>'));
			ok(
				'res_before',
				$('#test_before span').get(0).classList.contains('span2')
				&& $('#test_before span').get(1).classList.contains('span3')
				&& $('#test_before span').get(2).classList.contains('span4')
				&& $('#test_before div').get(0).innerText === 'Text'
			);
		})</script>
		</td>
	</tr>
	<tr>
		<td id="test_append">.append(content)<div style="display: none;"><span class="span1"></span></div></td>
		<td id="res_append" class="error">
			<script>$(() => {
				$('#test_append .span1').append('<span class="span2"></span>');
				$('#test_append .span1').append('Text');
				const el = document.createElement('span');
				el.className = 'span3'
				$('#test_append .span1').append(el);
				$('#test_append .span1').append($('<span class="span4"></span>'));
				ok(
					'res_append',
					$('#test_append .span1 span').get(0).classList.contains('span2')
					&& $('#test_append .span1 span').get(1).classList.contains('span3')
					&& $('#test_append .span1 span').get(2).classList.contains('span4')
					&& $('#test_append .span1').get(0).innerText === 'Text'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_prepend">.prepend(content)<div style="display: none;"><span class="span1"></span></div></td>
		<td id="res_prepend" class="error">
			<script>$(() => {
				$('#test_prepend .span1').prepend('<span class="span2"></span>');
				$('#test_prepend .span1').prepend('Text');
				const el = document.createElement('span');
				el.className = 'span3'
				$('#test_prepend .span1').prepend(el);
				$('#test_prepend .span1').prepend($('<span class="span4"></span>'));
				ok(
					'res_prepend',
					$('#test_prepend .span1 span').get(0).classList.contains('span4')
					&& $('#test_prepend .span1 span').get(1).classList.contains('span3')
					&& $('#test_prepend .span1 span').get(2).classList.contains('span2')
					&& $('#test_prepend .span1').get(0).innerText === 'Text'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_text">.text()<div style="display: none;"><span class="span1">test</span></div></td>
		<td id="res_text" class="error">
			<script>$(() => {
				ok(
					'res_text',
					$('#test_text .span1').text() === 'test'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_val">.val()<div style="display: none;"><input value="test" /><select><option value="1">1</option><option value="2" selected>2</option></select></div></td>
		<td id="res_val" class="error">
			<script>$(() => {
				ok(
					'res_val',
					$('#test_val input').val() === 'test'
				  	&& $('#test_val select').val() === '2'
				    && $('#test_val input').val('changed')
				  	&& $('#test_val input').val() === 'changed'
					&& $('#test_val select').val('1')
					&& $('#test_val select').val() === '1'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_attr">.attr()<div style="display: none;"><span data-value="test"></span></div></td>
		<td id="res_attr" class="error">
			<script>$(() => {
				ok(
					'res_attr',
					$('#test_attr span').attr('data-value') === 'test'
					&& $('#test_attr span').attr('data-no-value') === null
					&& $('#test_attr span').attr('data-value', 'changed')
					&& $('#test_attr span').attr('data-value') === 'changed'
					&& $('#test_attr span').removeAttr('data-value')
					&& $('#test_attr span').attr('data-value') === null
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_html">.html()<div style="display: none;"><span class="span1">test<br>test</span><span class="span2">test<br>test</span></div></td>
		<td id="res_html" class="error">
			<script>$(() => {
				ok(
					'res_html',
					$('#test_html span').html() === 'test<br>testtest<br>test'
					&& $('#test_html span').html('test<br>')
					&& $('#test_html span').html() === 'test<br>test<br>'
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_focus">.focus()<div style="display: none;"><input /></div></td>
		<td id="res_focus" class="error">
			<script>$(() => {
				$('#test_focus div').show();
				$('#test_focus input').focus();
				ok(
					'res_focus',
					$('#test_focus input').get(0) === document.activeElement
				);
				$('#test_focus div').hide();
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_find">.find()<div style="display: none;"><div class="outer"><div class="inner inner1"></div></div><div class="outer"><div class="inner inner2"></div></div><div class="outer"></div><div class="inner inner3"></div></div></td>
		<td id="res_find" class="error">
			<script>$(() => {
				ok(
					'res_find',
					$('#test_find div.outer').find('div.inner').length === 2
					&& $('#test_find div.outer').find('div.inner').addClass('add')
					&& $('#test_find .inner1').hasClass('add')
					&& $('#test_find .inner2').hasClass('add')
					&& !$('#test_find .inner3').hasClass('add')
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_parent">.parent()<div style="display: none;"><div class="outer"><div class="inner inner1"></div><div class="inner inner2"></div></div></div></td>
		<td id="res_parent" class="error">
			<script>$(() => {
				ok(
					'res_parent',
					$('#test_parent div.inner1').parent().hasClass('outer')
					&& $('#test_parent div.inner').parent().length === 1
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_parents">.parents()<div style="display: none;"><div class="outer"><div class="inner inner1"></div><div class="inner inner2"><div class="inner-level2"></div></div></div></td>
		<td id="res_parents" class="error">
			<script>$(() => {
				ok(
					'res_parents',
					$('#test_parents div.inner-level2').parents('.outer').hasClass('outer')
					&& $('#test_parents div.inner-level2').parents('.inner').hasClass('inner2')
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_filter">.filter()<div style="display: none;"><div class="inner inner1"></div><div class="inner inner2"><div class="inner inner2"></div></div></div></td>
		<td id="res_filter" class="error">
			<script>$(() => {
				ok(
					'res_filter',
					$('#test_filter div.inner').length === 3
					&& $('#test_filter div.inner').filter('.inner1').length === 1
					&& $('#test_filter div.inner').filter('.inner2').length === 2
				);
			})</script>
		</td>
	</tr>
	<tr>
		<td id="test_siblings">.siblings()<div style="display: none;"><div class="inner1"></div><div class="inner-not1"></div><div class="inner-not1"></div></div></td>
		<td id="res_siblings" class="error">
			<script>$(() => {
				ok(
					'res_siblings',
					$('#test_siblings div.inner1').siblings().hasClass('inner-not1')
					&& $('#test_siblings div.inner1').siblings().length === 2
				);
			})</script>
		</td>
	</tr>
	<tr><td colspan="2"><b>Events</b></td></tr>
	<tr>
		<td id="test_on">.on()<div style="display: none;"><div class="outer"><div class="inner inner1"><div class="inner inner2"></div></div></div></td>
		<td id="res_on" class="error">
			<script>$(() => {
							let counterOuter = 0;
							let counterInner = 0;
							$('#test_on div.outer').on('click', function () {
								counterOuter++;
							});
							$('#test_on div.outer').on('click', '.inner', function () {
								counterInner++;
							});

							let event = document.createEvent('HTMLEvents');
							event.initEvent('click', true, false);
							$('#test_on .outer').get(0).dispatchEvent(event);
							$('#test_on .inner1').get(0).dispatchEvent(event);
							$('#test_on .inner2').get(0).dispatchEvent(event);

							ok(
								'res_on',
								counterOuter === 3
								&& counterInner === 2
							);
						})</script>
		</td>
	</tr>
	<tr>
		<td id="test_click">.click()</td>
		<td id="res_click"></td>
	</tr>
	<tr>
		<td id="test_submit">.submit()</td>
		<td id="res_submit"></td>
	</tr>
	<tr>
		<td id="test_keyup">.keyup()</td>
		<td id="res_keyup"></td>
	</tr>
</table>

</body>
</html>
